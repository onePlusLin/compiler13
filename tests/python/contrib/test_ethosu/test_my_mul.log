[15:51:58] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/runtime/logging.cc:336: TVM_LOG_DEBUG enables VLOG statements in 'ir/transform.cc' up to level 1
[15:51:58] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/runtime/logging.cc:336: TVM_LOG_DEBUG enables VLOG statements in 'relay/ir/transform.cc' up to level 1
[15:51:58] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/target/target_kind.cc:181: Warning: Unable to detect CUDA version, default to "-arch=sm_50" instead
2025-12-04 15:51:59.148077: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
enabled targets: llvm
pytest marker: 
============================= test session starts ==============================
platform linux -- Python 3.8.18, pytest-8.3.4, pluggy-1.5.0
rootdir: /home/linzejia/app/tvm/apache-tvm-src-v0.13.0
configfile: pyproject.toml
plugins: anyio-3.7.1, typeguard-4.3.0
collected 96 items / 92 deselected / 4 selected

test_replace_binary_elementwise.py [15:52:00] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:00] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:00] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:00] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:00] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/relay/backend/te_compiler_cache.cc:1186: Constant tensors map size: 0
zedebug:***************** _lower_to_tir: *****************
zedebug: extract_constants before,func:
 fn (%ifm: Tensor[(1, 5, 9, 3), int8] /* ty=Tensor[(1, 5, 9, 3), int8] */) -> Tensor[(1, 5, 9, 3), int8] {
  contrib.ethosu.binary_elementwise(%ifm, %ifm, meta[relay.Constant][0] /* ty=Tensor[(0), int8] */, operator_type="MUL", ifm_scale=1f, ifm_zero_point=0, ifm2_scale=1f, ifm2_zero_point=0, ofm_scale=1f, ofm_zero_point=0, ifm_channels=3, ifm2_channels=3, ofm_dtype="int8") /* ty=Tensor[(1, 5, 9, 3), int8] */
} /* ty=fn (Tensor[(1, 5, 9, 3), int8]) -> Tensor[(1, 5, 9, 3), int8] */

zedebug: extract_constants after,func:
 fn (%ifm: Tensor[(1, 5, 9, 3), int8] /* ty=Tensor[(1, 5, 9, 3), int8] */, %p1: Tensor[(0), int8] /* ty=Tensor[(0), int8] */) -> Tensor[(1, 5, 9, 3), int8] {
  contrib.ethosu.binary_elementwise(%ifm, %ifm, %p1, operator_type="MUL", ifm_scale=1f, ifm_zero_point=0, ifm2_scale=1f, ifm2_zero_point=0, ofm_scale=1f, ofm_zero_point=0, ifm_channels=3, ifm2_channels=3, ofm_dtype="int8") /* ty=Tensor[(1, 5, 9, 3), int8] */
} /* ty=fn (Tensor[(1, 5, 9, 3), int8], Tensor[(0), int8]) -> Tensor[(1, 5, 9, 3), int8] */
zedebug: extract_constants after,consts:
 {1: array([], dtype=int8)}
zedebug:lower_to_te befor  func :
 fn (%ifm: Tensor[(1, 5, 9, 3), int8] /* ty=Tensor[(1, 5, 9, 3), int8] */, %p1: Tensor[(0), int8] /* ty=Tensor[(0), int8] */) -> Tensor[(1, 5, 9, 3), int8] {
  contrib.ethosu.binary_elementwise(%ifm, %ifm, %p1, operator_type="MUL", ifm_scale=1f, ifm_zero_point=0, ifm2_scale=1f, ifm2_zero_point=0, ofm_scale=1f, ofm_zero_point=0, ifm_channels=3, ifm2_channels=3, ofm_dtype="int8") /* ty=Tensor[(1, 5, 9, 3), int8] */
} /* ty=fn (Tensor[(1, 5, 9, 3), int8], Tensor[(0), int8]) -> Tensor[(1, 5, 9, 3), int8] */
zedebug:lower_to_te after  cached_func:
 relay.CachedFunc(0x60fc359b9aa0)
#[version = "0.0.5"]

cached_func.outputs:
 [Tensor(shape=[1, 5, 9, 3], op.name=ethosu_write)]
cached_func.inputs:
 [Tensor(shape=[1, 5, 9, 3], op.name=ifm), Tensor(shape=[0], op.name=p1)]
zedebug:lower_to_tir:schedule:s:
 schedule(0x60fc3581e9b0)
zedebug:lower_to_tir:cached_func:
 relay.CachedFunc(0x60fc359b9aa0)
before schedule_to_module,sch:
 schedule(0x60fc358c7890)
before schedule_to_module,args:
 [Tensor(shape=[1, 5, 9, 3], op.name=ifm), Tensor(shape=[0], op.name=p1), Tensor(shape=[1, 5, 9, 3], op.name=ethosu_write)]
before schedule_to_module,name:
 main
after schedule_to_module,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read[0:1, 0:5, 0:9, 0:3])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read[i0, i1, i2, i3] = ifm[i0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:5, 0:9, 0:3])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc[i0_1, i1, i2, i3] = ethosu_read[i0_1, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale[0:1, 0:5, 0:9, 0:3])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale[nn, hh, ww, cc] = ethosu_convert_to_nhwc[nn, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad[0:1, 0:5, 0:9, 0:3])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad[nn_1, hh, ww, cc] = ethosu_upscale[nn_1, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read_1[0:1, 0:5, 0:9, 0:3])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i0_2, i1, i2, i3] = ifm[i0_2, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:5, 0:9, 0:3])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i0_3, i1, i2, i3] = ethosu_read_1[i0_3, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:5, 0:9, 0:3])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[nn_2, hh, ww, cc] = ethosu_convert_to_nhwc_1[nn_2, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad_1[0:1, 0:5, 0:9, 0:3])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[nn_3, hh, ww, cc] = ethosu_upscale_1[nn_3, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:5, 0:9, 0:3])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise[nn_4, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[nn_4, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:5, 0:9, 0:3])
        i0_4 = T.int32()
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16[i0_4, i1, i2, i3] = ethosu_binary_elementwise[i0_4, i1, i2, i3]
        T.realize(ethosu_write[0:1, 0:5, 0:9, 0:3])
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write[i0_5, i1, i2, i3] = ethosu_convert_to_nhcwb16[i0_5, i1, i2, i3]
after Simplify,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read[0:1, 0:5, 0:9, 0:3])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:5, 0:9, 0:3])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc[0, i1, i2, i3] = ethosu_read[0, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale[0:1, 0:5, 0:9, 0:3])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale[0, hh, ww, cc] = ethosu_convert_to_nhwc[0, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad[0:1, 0:5, 0:9, 0:3])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad[0, hh, ww, cc] = ethosu_upscale[0, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read_1[0:1, 0:5, 0:9, 0:3])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:5, 0:9, 0:3])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[0, i1, i2, i3] = ethosu_read_1[0, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:5, 0:9, 0:3])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[0, hh, ww, cc] = ethosu_convert_to_nhwc_1[0, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad_1[0:1, 0:5, 0:9, 0:3])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[0, hh, ww, cc] = ethosu_upscale_1[0, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:5, 0:9, 0:3])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise[0, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[0, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:5, 0:9, 0:3])
        i0_4 = T.int32()
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16[0, i1, i2, i3] = ethosu_binary_elementwise[0, i1, i2, i3]
        T.realize(ethosu_write[0:1, 0:5, 0:9, 0:3])
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write[0, i1, i2, i3] = ethosu_convert_to_nhcwb16[0, i1, i2, i3]
after RemoveConcatenates,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read[0:1, 0:5, 0:9, 0:3])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:5, 0:9, 0:3])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc[0, i1, i2, i3] = ethosu_read[0, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale[0:1, 0:5, 0:9, 0:3])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale[0, hh, ww, cc] = ethosu_convert_to_nhwc[0, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad[0:1, 0:5, 0:9, 0:3])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad[0, hh, ww, cc] = ethosu_upscale[0, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read_1[0:1, 0:5, 0:9, 0:3])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:5, 0:9, 0:3])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[0, i1, i2, i3] = ethosu_read_1[0, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:5, 0:9, 0:3])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[0, hh, ww, cc] = ethosu_convert_to_nhwc_1[0, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad_1[0:1, 0:5, 0:9, 0:3])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[0, hh, ww, cc] = ethosu_upscale_1[0, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:5, 0:9, 0:3])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise[0, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[0, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:5, 0:9, 0:3])
        i0_4 = T.int32()
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16[0, i1, i2, i3] = ethosu_binary_elementwise[0, i1, i2, i3]
        T.realize(ethosu_write[0:1, 0:5, 0:9, 0:3])
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write[0, i1, i2, i3] = ethosu_convert_to_nhcwb16[0, i1, i2, i3]
after InjectRollingBuffer,mod:
 [15:52:00] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.BufferShapeLegalize
[15:52:00] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.BufferStrideLegalize
[15:52:00] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.ThreadScopePropagate
[15:52:00] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.BufferBindUnwrapper
[15:52:00] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.ApplyLayoutTransforms
[15:52:00] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.StorageFlattener
[15:52:00] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.AssertSimplifier
# from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read[0:1, 0:5, 0:9, 0:3])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:5, 0:9, 0:3])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc[0, i1, i2, i3] = ethosu_read[0, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale[0:1, 0:5, 0:9, 0:3])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale[0, hh, ww, cc] = ethosu_convert_to_nhwc[0, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad[0:1, 0:5, 0:9, 0:3])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad[0, hh, ww, cc] = ethosu_upscale[0, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read_1[0:1, 0:5, 0:9, 0:3])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:5, 0:9, 0:3])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[0, i1, i2, i3] = ethosu_read_1[0, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:5, 0:9, 0:3])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[0, hh, ww, cc] = ethosu_convert_to_nhwc_1[0, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad_1[0:1, 0:5, 0:9, 0:3])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[0, hh, ww, cc] = ethosu_upscale_1[0, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:5, 0:9, 0:3])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise[0, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[0, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:5, 0:9, 0:3])
        i0_4 = T.int32()
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16[0, i1, i2, i3] = ethosu_binary_elementwise[0, i1, i2, i3]
        T.realize(ethosu_write[0:1, 0:5, 0:9, 0:3])
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write[0, i1, i2, i3] = ethosu_convert_to_nhcwb16[0, i1, i2, i3]
after StorageFlatten,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([135], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((135,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc = T.allocate([135], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i1 * 27 + i2 * 3 + i3] = ethosu_read_1[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale = T.allocate([135], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((135,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_1[hh * 27 + ww * 3 + cc]
        ethosu_pad = T.allocate([135], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((135,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[hh * 27 + ww * 3 + cc] = ethosu_upscale_1[hh * 27 + ww * 3 + cc]
        ethosu_read_2 = T.allocate([135], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((135,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_3[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([135], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_3[i1 * 27 + i2 * 3 + i3] = ethosu_read_3[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale_2 = T.allocate([135], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((135,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_3[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_3[hh * 27 + ww * 3 + cc]
        ethosu_pad_2 = T.allocate([135], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((135,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_3[hh * 27 + ww * 3 + cc] = ethosu_upscale_3[hh * 27 + ww * 3 + cc]
        ethosu_binary_elementwise = T.allocate([135], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((135,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise_1[hh * 27 + ww * 3 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 27 + ww * 3 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 27 + ww * 3 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([135], "int8", "global")
        i0_4 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3] = ethosu_binary_elementwise_1[i1 * 27 + i2 * 3 + i3]
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 27 + i2 * 3 + i3] = ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3]
after UnrollLoop,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([135], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((135,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc = T.allocate([135], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i1 * 27 + i2 * 3 + i3] = ethosu_read_1[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale = T.allocate([135], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((135,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_1[hh * 27 + ww * 3 + cc]
        ethosu_pad = T.allocate([135], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((135,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[hh * 27 + ww * 3 + cc] = ethosu_upscale_1[hh * 27 + ww * 3 + cc]
        ethosu_read_2 = T.allocate([135], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((135,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_3[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([135], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_3[i1 * 27 + i2 * 3 + i3] = ethosu_read_3[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale_2 = T.allocate([135], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((135,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_3[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_3[hh * 27 + ww * 3 + cc]
        ethosu_pad_2 = T.allocate([135], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((135,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_3[hh * 27 + ww * 3 + cc] = ethosu_upscale_3[hh * 27 + ww * 3 + cc]
        ethosu_binary_elementwise = T.allocate([135], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((135,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise_1[hh * 27 + ww * 3 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 27 + ww * 3 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 27 + ww * 3 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([135], "int8", "global")
        i0_4 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3] = ethosu_binary_elementwise_1[i1 * 27 + i2 * 3 + i3]
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 27 + i2 * 3 + i3] = ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3]
after Simplify,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([135], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((135,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc = T.allocate([135], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i1 * 27 + i2 * 3 + i3] = ethosu_read_1[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale = T.allocate([135], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((135,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_1[hh * 27 + ww * 3 + cc]
        ethosu_pad = T.allocate([135], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((135,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[hh * 27 + ww * 3 + cc] = ethosu_upscale_1[hh * 27 + ww * 3 + cc]
        ethosu_read_2 = T.allocate([135], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((135,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_3[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([135], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_3[i1 * 27 + i2 * 3 + i3] = ethosu_read_3[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale_2 = T.allocate([135], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((135,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_3[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_3[hh * 27 + ww * 3 + cc]
        ethosu_pad_2 = T.allocate([135], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((135,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_3[hh * 27 + ww * 3 + cc] = ethosu_upscale_3[hh * 27 + ww * 3 + cc]
        ethosu_binary_elementwise = T.allocate([135], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((135,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise_1[hh * 27 + ww * 3 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 27 + ww * 3 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 27 + ww * 3 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([135], "int8", "global")
        i0_4 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3] = ethosu_binary_elementwise_1[i1 * 27 + i2 * 3 + i3]
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 27 + i2 * 3 + i3] = ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3]
after LoopPartition,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([135], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((135,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc = T.allocate([135], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i1 * 27 + i2 * 3 + i3] = ethosu_read_1[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale = T.allocate([135], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((135,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_1[hh * 27 + ww * 3 + cc]
        ethosu_pad = T.allocate([135], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((135,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[hh * 27 + ww * 3 + cc] = ethosu_upscale_1[hh * 27 + ww * 3 + cc]
        ethosu_read_2 = T.allocate([135], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((135,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_3[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([135], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_3[i1 * 27 + i2 * 3 + i3] = ethosu_read_3[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale_2 = T.allocate([135], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((135,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_3[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_3[hh * 27 + ww * 3 + cc]
        ethosu_pad_2 = T.allocate([135], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((135,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_3[hh * 27 + ww * 3 + cc] = ethosu_upscale_3[hh * 27 + ww * 3 + cc]
        ethosu_binary_elementwise = T.allocate([135], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((135,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise_1[hh * 27 + ww * 3 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 27 + ww * 3 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 27 + ww * 3 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([135], "int8", "global")
        i0_4 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3] = ethosu_binary_elementwise_1[i1 * 27 + i2 * 3 + i3]
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 27 + i2 * 3 + i3] = ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3]
after RemoveZeroStores,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([135], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((135,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc = T.allocate([135], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i1 * 27 + i2 * 3 + i3] = ethosu_read_1[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale = T.allocate([135], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((135,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_1[hh * 27 + ww * 3 + cc]
        ethosu_pad = T.allocate([135], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((135,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[hh * 27 + ww * 3 + cc] = ethosu_upscale_1[hh * 27 + ww * 3 + cc]
        ethosu_read_2 = T.allocate([135], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((135,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_3[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([135], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_3[i1 * 27 + i2 * 3 + i3] = ethosu_read_3[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale_2 = T.allocate([135], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((135,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_3[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_3[hh * 27 + ww * 3 + cc]
        ethosu_pad_2 = T.allocate([135], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((135,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_3[hh * 27 + ww * 3 + cc] = ethosu_upscale_3[hh * 27 + ww * 3 + cc]
        ethosu_binary_elementwise = T.allocate([135], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((135,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise_1[hh * 27 + ww * 3 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 27 + ww * 3 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 27 + ww * 3 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([135], "int8", "global")
        i0_4 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3] = ethosu_binary_elementwise_1[i1 * 27 + i2 * 3 + i3]
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 27 + i2 * 3 + i3] = ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3]
after Simplify,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([135], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((135,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc = T.allocate([135], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i1 * 27 + i2 * 3 + i3] = ethosu_read_1[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale = T.allocate([135], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((135,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_1[hh * 27 + ww * 3 + cc]
        ethosu_pad = T.allocate([135], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((135,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[hh * 27 + ww * 3 + cc] = ethosu_upscale_1[hh * 27 + ww * 3 + cc]
        ethosu_read_2 = T.allocate([135], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((135,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_3[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([135], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_3[i1 * 27 + i2 * 3 + i3] = ethosu_read_3[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale_2 = T.allocate([135], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((135,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_3[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_3[hh * 27 + ww * 3 + cc]
        ethosu_pad_2 = T.allocate([135], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((135,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_3[hh * 27 + ww * 3 + cc] = ethosu_upscale_3[hh * 27 + ww * 3 + cc]
        ethosu_binary_elementwise = T.allocate([135], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((135,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise_1[hh * 27 + ww * 3 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 27 + ww * 3 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 27 + ww * 3 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([135], "int8", "global")
        i0_4 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3] = ethosu_binary_elementwise_1[i1 * 27 + i2 * 3 + i3]
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 27 + i2 * 3 + i3] = ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3]
after RemoveNoOp,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([135], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((135,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc = T.allocate([135], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i1 * 27 + i2 * 3 + i3] = ethosu_read_1[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale = T.allocate([135], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((135,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_1[hh * 27 + ww * 3 + cc]
        ethosu_pad = T.allocate([135], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((135,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[hh * 27 + ww * 3 + cc] = ethosu_upscale_1[hh * 27 + ww * 3 + cc]
        ethosu_read_2 = T.allocate([135], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((135,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_3[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([135], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_3[i1 * 27 + i2 * 3 + i3] = ethosu_read_3[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale_2 = T.allocate([135], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((135,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_3[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_3[hh * 27 + ww * 3 + cc]
        ethosu_pad_2 = T.allocate([135], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((135,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_3[hh * 27 + ww * 3 + cc] = ethosu_upscale_3[hh * 27 + ww * 3 + cc]
        ethosu_binary_elementwise = T.allocate([135], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((135,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise_1[hh * 27 + ww * 3 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 27 + ww * 3 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 27 + ww * 3 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([135], "int8", "global")
        i0_4 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3] = ethosu_binary_elementwise_1[i1 * 27 + i2 * 3 + i3]
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 27 + i2 * 3 + i3] = ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3]
after ReplaceOperators,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
after ReplaceOperators,mod:
  main_func before MergeConstantsMutator: 
# from tvm.script import tir as T

@T.prim_func
def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
    T.func_attr({"ethos-u.const_dict": {}, "from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
    ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
    ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
    T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
params is :
 [ifm, ethosu_write]
body is :
 ifm = T.Buffer((135,), "int8")
ethosu_write = T.Buffer((135,), "int8")
T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
buffer_map is :
 {ethosu_write: ethosu_write, ifm: ifm}
attrs is :
 {"ethos-u.const_dict": {}, "from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)}
# from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
after EncodeConstants,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
after EncodeConstants,const_dict:
 {}
after HoistAllocates,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
after RemoveNoOp,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
------------------------MergeConstants------------------------
mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
const_dict:
 {}
after MergeConstants
mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
const_dict:
 {} 
------------------------End MergeConstants------------------------
zedebug:lower_ethosu after:mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
zedebug:lower_ethosu after:consts:
 {}
zedebug:***************** _lower_to_tir end *****************
# from tvm.script import tir as T

@T.prim_func
def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
    T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
    ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
    ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
    T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
.[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/relay/backend/te_compiler_cache.cc:1186: Constant tensors map size: 0
zedebug:***************** _lower_to_tir: *****************
zedebug: extract_constants before,func:
 fn (%ifm: Tensor[(1, 8, 9, 40), int8] /* ty=Tensor[(1, 8, 9, 40), int8] */) -> Tensor[(1, 8, 3, 9, 16), int8] {
  contrib.ethosu.binary_elementwise(%ifm, %ifm, meta[relay.Constant][0] /* ty=Tensor[(0), int8] */, operator_type="MUL", ifm_scale=1f, ifm_zero_point=0, ifm2_scale=1f, ifm2_zero_point=0, ofm_scale=1f, ofm_zero_point=0, ifm_channels=40, ifm2_channels=40, ofm_layout="NHCWB16", ofm_dtype="int8") /* ty=Tensor[(1, 8, 3, 9, 16), int8] */
} /* ty=fn (Tensor[(1, 8, 9, 40), int8]) -> Tensor[(1, 8, 3, 9, 16), int8] */

zedebug: extract_constants after,func:
 fn (%ifm: Tensor[(1, 8, 9, 40), int8] /* ty=Tensor[(1, 8, 9, 40), int8] */, %p1: Tensor[(0), int8] /* ty=Tensor[(0), int8] */) -> Tensor[(1, 8, 3, 9, 16), int8] {
  contrib.ethosu.binary_elementwise(%ifm, %ifm, %p1, operator_type="MUL", ifm_scale=1f, ifm_zero_point=0, ifm2_scale=1f, ifm2_zero_point=0, ofm_scale=1f, ofm_zero_point=0, ifm_channels=40, ifm2_channels=40, ofm_layout="NHCWB16", ofm_dtype="int8") /* ty=Tensor[(1, 8, 3, 9, 16), int8] */
} /* ty=fn (Tensor[(1, 8, 9, 40), int8], Tensor[(0), int8]) -> Tensor[(1, 8, 3, 9, 16), int8] */
zedebug: extract_constants after,consts:
 {1: array([], dtype=int8)}
zedebug:lower_to_te befor  func :
 fn (%ifm: Tensor[(1, 8, 9, 40), int8] /* ty=Tensor[(1, 8, 9, 40), int8] */, %p1: Tensor[(0), int8] /* ty=Tensor[(0), int8] */) -> Tensor[(1, 8, 3, 9, 16), int8] {
  contrib.ethosu.binary_elementwise(%ifm, %ifm, %p1, operator_type="MUL", ifm_scale=1f, ifm_zero_point=0, ifm2_scale=1f, ifm2_zero_point=0, ofm_scale=1f, ofm_zero_point=0, ifm_channels=40, ifm2_channels=40, ofm_layout="NHCWB16", ofm_dtype="int8") /* ty=Tensor[(1, 8, 3, 9, 16), int8] */
} /* ty=fn (Tensor[(1, 8, 9, 40), int8], Tensor[(0), int8]) -> Tensor[(1, 8, 3, 9, 16), int8] */
zedebug:lower_to_te after  cached_func:
 relay.CachedFunc(0x60fc35ae4f00)
#[version = "0.0.5"]

cached_func.outputs:
 [Tensor(shape=[1, 8, 3, 9, 16], op.name=ethosu_write)]
cached_func.inputs:
 [Tensor(shape=[1, 8, 9, 40], op.name=ifm), Tensor(shape=[0], op.name=p1)]
zedebug:lower_to_tir:schedule:s:
 schedule(0x60fc35b34370)
zedebug:lower_to_tir:cached_func:
 relay.CachedFunc(0x60fc35ae4f00)
before schedule_to_module,sch:
 schedule(0x60fc35af2620)
before schedule_to_module,args:
 [Tensor(shape=[1, 8, 9, 40], op.name=ifm), Tensor(shape=[0], op.name=p1), Tensor(shape=[1, 8, 3, 9, 16], op.name=ethosu_write)]
before schedule_to_module,name:
 main
after schedule_to_module,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read[0:1, 0:8, 0:9, 0:40])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read[i0, i1, i2, i3] = ifm[i0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:8, 0:9, 0:40])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc[i0_1, i1, i2, i3] = ethosu_read[i0_1, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale[0:1, 0:8, 0:9, 0:40])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale[nn, hh, ww, cc] = ethosu_convert_to_nhwc[nn, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad[0:1, 0:8, 0:9, 0:40])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad[nn_1, hh, ww, cc] = ethosu_upscale[nn_1, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read_1[0:1, 0:8, 0:9, 0:40])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i0_2, i1, i2, i3] = ifm[i0_2, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:8, 0:9, 0:40])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i0_3, i1, i2, i3] = ethosu_read_1[i0_3, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:8, 0:9, 0:40])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[nn_2, hh, ww, cc] = ethosu_convert_to_nhwc_1[nn_2, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad_1[0:1, 0:8, 0:9, 0:40])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[nn_3, hh, ww, cc] = ethosu_upscale_1[nn_3, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:8, 0:9, 0:40])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise[nn_4, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[nn_4, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 8, 3, 9, 16), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:8, 0:3, 0:9, 0:16])
        nn_5 = T.int32()
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16[nn_5, hh, cc, ww, cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise[nn_5, hh, ww, cc * 16 + cb], T.int8(0))
        T.realize(ethosu_write[0:1, 0:8, 0:3, 0:9, 0:16])
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write[i0_4, i1, i2, i3, i4] = ethosu_convert_to_nhcwb16[i0_4, i1, i2, i3, i4]
after Simplify,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read[0:1, 0:8, 0:9, 0:40])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:8, 0:9, 0:40])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc[0, i1, i2, i3] = ethosu_read[0, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale[0:1, 0:8, 0:9, 0:40])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale[0, hh, ww, cc] = ethosu_convert_to_nhwc[0, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad[0:1, 0:8, 0:9, 0:40])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad[0, hh, ww, cc] = ethosu_upscale[0, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read_1[0:1, 0:8, 0:9, 0:40])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:8, 0:9, 0:40])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[0, i1, i2, i3] = ethosu_read_1[0, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:8, 0:9, 0:40])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[0, hh, ww, cc] = ethosu_convert_to_nhwc_1[0, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad_1[0:1, 0:8, 0:9, 0:40])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[0, hh, ww, cc] = ethosu_upscale_1[0, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:8, 0:9, 0:40])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise[0, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[0, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 8, 3, 9, 16), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:8, 0:3, 0:9, 0:16])
        nn_5 = T.int32()
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16[0, hh, cc, ww, cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise[0, hh, ww, cc * 16 + cb], T.int8(0))
        T.realize(ethosu_write[0:1, 0:8, 0:3, 0:9, 0:16])
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write[0, i1, i2, i3, i4] = ethosu_convert_to_nhcwb16[0, i1, i2, i3, i4]
after RemoveConcatenates,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read[0:1, 0:8, 0:9, 0:40])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:8, 0:9, 0:40])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc[0, i1, i2, i3] = ethosu_read[0, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale[0:1, 0:8, 0:9, 0:40])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale[0, hh, ww, cc] = ethosu_convert_to_nhwc[0, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad[0:1, 0:8, 0:9, 0:40])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad[0, hh, ww, cc] = ethosu_upscale[0, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read_1[0:1, 0:8, 0:9, 0:40])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:8, 0:9, 0:40])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[0, i1, i2, i3] = ethosu_read_1[0, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:8, 0:9, 0:40])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[0, hh, ww, cc] = ethosu_convert_to_nhwc_1[0, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad_1[0:1, 0:8, 0:9, 0:40])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[0, hh, ww, cc] = ethosu_upscale_1[0, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:8, 0:9, 0:40])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise[0, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[0, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 8, 3, 9, 16), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:8, 0:3, 0:9, 0:16])
        nn_5 = T.int32()
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16[0, hh, cc, ww, cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise[0, hh, ww, cc * 16 + cb], T.int8(0))
        T.realize(ethosu_write[0:1, 0:8, 0:3, 0:9, 0:16])
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write[0, i1, i2, i3, i4] = ethosu_convert_to_nhcwb16[0, i1, i2, i3, i4]
after InjectRollingBuffer,mod:
 [15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.BufferShapeLegalize
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.BufferStrideLegalize
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.ThreadScopePropagate
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.BufferBindUnwrapper
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.ApplyLayoutTransforms
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.StorageFlattener
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.AssertSimplifier
# from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read[0:1, 0:8, 0:9, 0:40])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:8, 0:9, 0:40])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc[0, i1, i2, i3] = ethosu_read[0, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale[0:1, 0:8, 0:9, 0:40])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale[0, hh, ww, cc] = ethosu_convert_to_nhwc[0, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad[0:1, 0:8, 0:9, 0:40])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad[0, hh, ww, cc] = ethosu_upscale[0, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read_1[0:1, 0:8, 0:9, 0:40])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:8, 0:9, 0:40])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[0, i1, i2, i3] = ethosu_read_1[0, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:8, 0:9, 0:40])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[0, hh, ww, cc] = ethosu_convert_to_nhwc_1[0, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad_1[0:1, 0:8, 0:9, 0:40])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[0, hh, ww, cc] = ethosu_upscale_1[0, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:8, 0:9, 0:40])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise[0, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[0, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 8, 3, 9, 16), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:8, 0:3, 0:9, 0:16])
        nn_5 = T.int32()
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16[0, hh, cc, ww, cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise[0, hh, ww, cc * 16 + cb], T.int8(0))
        T.realize(ethosu_write[0:1, 0:8, 0:3, 0:9, 0:16])
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write[0, i1, i2, i3, i4] = ethosu_convert_to_nhcwb16[0, i1, i2, i3, i4]
after StorageFlatten,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([2880], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((2880,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc = T.allocate([2880], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i1 * 360 + i2 * 40 + i3] = ethosu_read_1[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale = T.allocate([2880], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((2880,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_1[hh * 360 + ww * 40 + cc]
        ethosu_pad = T.allocate([2880], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((2880,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[hh * 360 + ww * 40 + cc] = ethosu_upscale_1[hh * 360 + ww * 40 + cc]
        ethosu_read_2 = T.allocate([2880], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((2880,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_3[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([2880], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_3[i1 * 360 + i2 * 40 + i3] = ethosu_read_3[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale_2 = T.allocate([2880], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((2880,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_3[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_3[hh * 360 + ww * 40 + cc]
        ethosu_pad_2 = T.allocate([2880], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((2880,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_3[hh * 360 + ww * 40 + cc] = ethosu_upscale_3[hh * 360 + ww * 40 + cc]
        ethosu_binary_elementwise = T.allocate([2880], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((2880,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 360 + ww * 40 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 360 + ww * 40 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([3456], "int8", "global")
        nn_5 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((3456,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16_1[hh * 432 + cc * 144 + ww * 16 + cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc * 16 + cb], T.int8(0))
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 432 + i2 * 144 + i3 * 16 + i4] = ethosu_convert_to_nhcwb16_1[i1 * 432 + i2 * 144 + i3 * 16 + i4]
after UnrollLoop,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([2880], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((2880,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc = T.allocate([2880], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i1 * 360 + i2 * 40 + i3] = ethosu_read_1[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale = T.allocate([2880], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((2880,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_1[hh * 360 + ww * 40 + cc]
        ethosu_pad = T.allocate([2880], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((2880,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[hh * 360 + ww * 40 + cc] = ethosu_upscale_1[hh * 360 + ww * 40 + cc]
        ethosu_read_2 = T.allocate([2880], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((2880,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_3[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([2880], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_3[i1 * 360 + i2 * 40 + i3] = ethosu_read_3[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale_2 = T.allocate([2880], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((2880,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_3[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_3[hh * 360 + ww * 40 + cc]
        ethosu_pad_2 = T.allocate([2880], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((2880,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_3[hh * 360 + ww * 40 + cc] = ethosu_upscale_3[hh * 360 + ww * 40 + cc]
        ethosu_binary_elementwise = T.allocate([2880], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((2880,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 360 + ww * 40 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 360 + ww * 40 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([3456], "int8", "global")
        nn_5 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((3456,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16_1[hh * 432 + cc * 144 + ww * 16 + cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc * 16 + cb], T.int8(0))
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 432 + i2 * 144 + i3 * 16 + i4] = ethosu_convert_to_nhcwb16_1[i1 * 432 + i2 * 144 + i3 * 16 + i4]
after Simplify,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([2880], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((2880,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc = T.allocate([2880], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i1 * 360 + i2 * 40 + i3] = ethosu_read_1[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale = T.allocate([2880], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((2880,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_1[hh * 360 + ww * 40 + cc]
        ethosu_pad = T.allocate([2880], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((2880,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[hh * 360 + ww * 40 + cc] = ethosu_upscale_1[hh * 360 + ww * 40 + cc]
        ethosu_read_2 = T.allocate([2880], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((2880,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_3[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([2880], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_3[i1 * 360 + i2 * 40 + i3] = ethosu_read_3[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale_2 = T.allocate([2880], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((2880,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_3[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_3[hh * 360 + ww * 40 + cc]
        ethosu_pad_2 = T.allocate([2880], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((2880,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_3[hh * 360 + ww * 40 + cc] = ethosu_upscale_3[hh * 360 + ww * 40 + cc]
        ethosu_binary_elementwise = T.allocate([2880], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((2880,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 360 + ww * 40 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 360 + ww * 40 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([3456], "int8", "global")
        nn_5 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((3456,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16_1[hh * 432 + cc * 144 + ww * 16 + cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc * 16 + cb], T.int8(0))
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 432 + i2 * 144 + i3 * 16 + i4] = ethosu_convert_to_nhcwb16_1[i1 * 432 + i2 * 144 + i3 * 16 + i4]
after LoopPartition,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([2880], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((2880,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc = T.allocate([2880], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i1 * 360 + i2 * 40 + i3] = ethosu_read_1[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale = T.allocate([2880], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((2880,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_1[hh * 360 + ww * 40 + cc]
        ethosu_pad = T.allocate([2880], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((2880,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[hh * 360 + ww * 40 + cc] = ethosu_upscale_1[hh * 360 + ww * 40 + cc]
        ethosu_read_2 = T.allocate([2880], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((2880,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_3[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([2880], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_3[i1 * 360 + i2 * 40 + i3] = ethosu_read_3[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale_2 = T.allocate([2880], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((2880,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_3[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_3[hh * 360 + ww * 40 + cc]
        ethosu_pad_2 = T.allocate([2880], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((2880,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_3[hh * 360 + ww * 40 + cc] = ethosu_upscale_3[hh * 360 + ww * 40 + cc]
        ethosu_binary_elementwise = T.allocate([2880], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((2880,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 360 + ww * 40 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 360 + ww * 40 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([3456], "int8", "global")
        nn_5 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((3456,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16_1[hh * 432 + cc * 144 + ww * 16 + cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc * 16 + cb], T.int8(0))
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 432 + i2 * 144 + i3 * 16 + i4] = ethosu_convert_to_nhcwb16_1[i1 * 432 + i2 * 144 + i3 * 16 + i4]
after RemoveZeroStores,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([2880], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((2880,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc = T.allocate([2880], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i1 * 360 + i2 * 40 + i3] = ethosu_read_1[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale = T.allocate([2880], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((2880,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_1[hh * 360 + ww * 40 + cc]
        ethosu_pad = T.allocate([2880], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((2880,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[hh * 360 + ww * 40 + cc] = ethosu_upscale_1[hh * 360 + ww * 40 + cc]
        ethosu_read_2 = T.allocate([2880], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((2880,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_3[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([2880], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_3[i1 * 360 + i2 * 40 + i3] = ethosu_read_3[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale_2 = T.allocate([2880], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((2880,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_3[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_3[hh * 360 + ww * 40 + cc]
        ethosu_pad_2 = T.allocate([2880], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((2880,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_3[hh * 360 + ww * 40 + cc] = ethosu_upscale_3[hh * 360 + ww * 40 + cc]
        ethosu_binary_elementwise = T.allocate([2880], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((2880,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 360 + ww * 40 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 360 + ww * 40 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([3456], "int8", "global")
        nn_5 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((3456,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16_1[hh * 432 + cc * 144 + ww * 16 + cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc * 16 + cb], T.int8(0))
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 432 + i2 * 144 + i3 * 16 + i4] = ethosu_convert_to_nhcwb16_1[i1 * 432 + i2 * 144 + i3 * 16 + i4]
after Simplify,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([2880], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((2880,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc = T.allocate([2880], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i1 * 360 + i2 * 40 + i3] = ethosu_read_1[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale = T.allocate([2880], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((2880,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_1[hh * 360 + ww * 40 + cc]
        ethosu_pad = T.allocate([2880], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((2880,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[hh * 360 + ww * 40 + cc] = ethosu_upscale_1[hh * 360 + ww * 40 + cc]
        ethosu_read_2 = T.allocate([2880], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((2880,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_3[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([2880], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_3[i1 * 360 + i2 * 40 + i3] = ethosu_read_3[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale_2 = T.allocate([2880], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((2880,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_3[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_3[hh * 360 + ww * 40 + cc]
        ethosu_pad_2 = T.allocate([2880], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((2880,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_3[hh * 360 + ww * 40 + cc] = ethosu_upscale_3[hh * 360 + ww * 40 + cc]
        ethosu_binary_elementwise = T.allocate([2880], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((2880,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 360 + ww * 40 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 360 + ww * 40 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([3456], "int8", "global")
        nn_5 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((3456,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16_1[hh * 432 + cc * 144 + ww * 16 + cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc * 16 + cb], T.int8(0))
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 432 + i2 * 144 + i3 * 16 + i4] = ethosu_convert_to_nhcwb16_1[i1 * 432 + i2 * 144 + i3 * 16 + i4]
after RemoveNoOp,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([2880], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((2880,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc = T.allocate([2880], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i1 * 360 + i2 * 40 + i3] = ethosu_read_1[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale = T.allocate([2880], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((2880,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_1[hh * 360 + ww * 40 + cc]
        ethosu_pad = T.allocate([2880], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((2880,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[hh * 360 + ww * 40 + cc] = ethosu_upscale_1[hh * 360 + ww * 40 + cc]
        ethosu_read_2 = T.allocate([2880], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((2880,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_3[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([2880], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_3[i1 * 360 + i2 * 40 + i3] = ethosu_read_3[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale_2 = T.allocate([2880], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((2880,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_3[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_3[hh * 360 + ww * 40 + cc]
        ethosu_pad_2 = T.allocate([2880], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((2880,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_3[hh * 360 + ww * 40 + cc] = ethosu_upscale_3[hh * 360 + ww * 40 + cc]
        ethosu_binary_elementwise = T.allocate([2880], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((2880,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "NONE")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 360 + ww * 40 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 360 + ww * 40 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([3456], "int8", "global")
        nn_5 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((3456,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16_1[hh * 432 + cc * 144 + ww * 16 + cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc * 16 + cb], T.int8(0))
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 432 + i2 * 144 + i3 * 16 + i4] = ethosu_convert_to_nhcwb16_1[i1 * 432 + i2 * 144 + i3 * 16 + i4]
after ReplaceOperators,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
after ReplaceOperators,mod:
  main_func before MergeConstantsMutator: 
# from tvm.script import tir as T

@T.prim_func
def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
    T.func_attr({"ethos-u.const_dict": {}, "from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
    ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
    ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
    T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
params is :
 [ifm, ethosu_write]
body is :
 ifm = T.Buffer((2880,), "int8")
ethosu_write = T.Buffer((3456,), "int8")
T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
buffer_map is :
 {ethosu_write: ethosu_write, ifm: ifm}
attrs is :
 {"ethos-u.const_dict": {}, "from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)}
# from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
after EncodeConstants,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
after EncodeConstants,const_dict:
 {}
after HoistAllocates,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
after RemoveNoOp,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
------------------------MergeConstants------------------------
mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
const_dict:
 {}
after MergeConstants
mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
const_dict:
 {} 
------------------------End MergeConstants------------------------
zedebug:lower_ethosu after:mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
zedebug:lower_ethosu after:consts:
 {}
zedebug:***************** _lower_to_tir end *****************
# from tvm.script import tir as T

@T.prim_func
def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
    T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
    ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
    ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
    T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "NONE", 0, 0, "TFL", 0, 0, 0, 0, 0, 0)
.[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/relay/backend/te_compiler_cache.cc:1186: Constant tensors map size: 0
zedebug:***************** _lower_to_tir: *****************
zedebug: extract_constants before,func:
 fn (%ifm: Tensor[(1, 5, 9, 3), int8] /* ty=Tensor[(1, 5, 9, 3), int8] */) -> Tensor[(1, 5, 9, 3), int8] {
  contrib.ethosu.binary_elementwise(%ifm, %ifm, meta[relay.Constant][0] /* ty=Tensor[(0), int8] */, operator_type="MUL", ifm_scale=1f, ifm_zero_point=0, ifm2_scale=1f, ifm2_zero_point=0, ofm_scale=1f, ofm_zero_point=0, ifm_channels=3, ifm2_channels=3, activation="CLIP", clip_min=10, clip_max=100, ofm_dtype="int8") /* ty=Tensor[(1, 5, 9, 3), int8] */
} /* ty=fn (Tensor[(1, 5, 9, 3), int8]) -> Tensor[(1, 5, 9, 3), int8] */

zedebug: extract_constants after,func:
 fn (%ifm: Tensor[(1, 5, 9, 3), int8] /* ty=Tensor[(1, 5, 9, 3), int8] */, %p1: Tensor[(0), int8] /* ty=Tensor[(0), int8] */) -> Tensor[(1, 5, 9, 3), int8] {
  contrib.ethosu.binary_elementwise(%ifm, %ifm, %p1, operator_type="MUL", ifm_scale=1f, ifm_zero_point=0, ifm2_scale=1f, ifm2_zero_point=0, ofm_scale=1f, ofm_zero_point=0, ifm_channels=3, ifm2_channels=3, activation="CLIP", clip_min=10, clip_max=100, ofm_dtype="int8") /* ty=Tensor[(1, 5, 9, 3), int8] */
} /* ty=fn (Tensor[(1, 5, 9, 3), int8], Tensor[(0), int8]) -> Tensor[(1, 5, 9, 3), int8] */
zedebug: extract_constants after,consts:
 {1: array([], dtype=int8)}
zedebug:lower_to_te befor  func :
 fn (%ifm: Tensor[(1, 5, 9, 3), int8] /* ty=Tensor[(1, 5, 9, 3), int8] */, %p1: Tensor[(0), int8] /* ty=Tensor[(0), int8] */) -> Tensor[(1, 5, 9, 3), int8] {
  contrib.ethosu.binary_elementwise(%ifm, %ifm, %p1, operator_type="MUL", ifm_scale=1f, ifm_zero_point=0, ifm2_scale=1f, ifm2_zero_point=0, ofm_scale=1f, ofm_zero_point=0, ifm_channels=3, ifm2_channels=3, activation="CLIP", clip_min=10, clip_max=100, ofm_dtype="int8") /* ty=Tensor[(1, 5, 9, 3), int8] */
} /* ty=fn (Tensor[(1, 5, 9, 3), int8], Tensor[(0), int8]) -> Tensor[(1, 5, 9, 3), int8] */
zedebug:lower_to_te after  cached_func:
 relay.CachedFunc(0x60fc36b2b0b0)
#[version = "0.0.5"]

cached_func.outputs:
 [Tensor(shape=[1, 5, 9, 3], op.name=ethosu_write)]
cached_func.inputs:
 [Tensor(shape=[1, 5, 9, 3], op.name=ifm), Tensor(shape=[0], op.name=p1)]
zedebug:lower_to_tir:schedule:s:
 schedule(0x60fc36b61220)
zedebug:lower_to_tir:cached_func:
 relay.CachedFunc(0x60fc36b2b0b0)
before schedule_to_module,sch:
 schedule(0x60fc36b23370)
before schedule_to_module,args:
 [Tensor(shape=[1, 5, 9, 3], op.name=ifm), Tensor(shape=[0], op.name=p1), Tensor(shape=[1, 5, 9, 3], op.name=ethosu_write)]
before schedule_to_module,name:
 main
after schedule_to_module,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read[0:1, 0:5, 0:9, 0:3])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read[i0, i1, i2, i3] = ifm[i0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:5, 0:9, 0:3])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc[i0_1, i1, i2, i3] = ethosu_read[i0_1, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale[0:1, 0:5, 0:9, 0:3])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale[nn, hh, ww, cc] = ethosu_convert_to_nhwc[nn, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad[0:1, 0:5, 0:9, 0:3])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad[nn_1, hh, ww, cc] = ethosu_upscale[nn_1, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read_1[0:1, 0:5, 0:9, 0:3])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i0_2, i1, i2, i3] = ifm[i0_2, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:5, 0:9, 0:3])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i0_3, i1, i2, i3] = ethosu_read_1[i0_3, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:5, 0:9, 0:3])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[nn_2, hh, ww, cc] = ethosu_convert_to_nhwc_1[nn_2, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad_1[0:1, 0:5, 0:9, 0:3])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[nn_3, hh, ww, cc] = ethosu_upscale_1[nn_3, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:5, 0:9, 0:3])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise[nn_4, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[nn_4, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:5, 0:9, 0:3])
        i0_4 = T.int32()
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16[i0_4, i1, i2, i3] = ethosu_binary_elementwise[i0_4, i1, i2, i3]
        T.realize(ethosu_write[0:1, 0:5, 0:9, 0:3])
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write[i0_5, i1, i2, i3] = ethosu_convert_to_nhcwb16[i0_5, i1, i2, i3]
after Simplify,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read[0:1, 0:5, 0:9, 0:3])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:5, 0:9, 0:3])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc[0, i1, i2, i3] = ethosu_read[0, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale[0:1, 0:5, 0:9, 0:3])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale[0, hh, ww, cc] = ethosu_convert_to_nhwc[0, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad[0:1, 0:5, 0:9, 0:3])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad[0, hh, ww, cc] = ethosu_upscale[0, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read_1[0:1, 0:5, 0:9, 0:3])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:5, 0:9, 0:3])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[0, i1, i2, i3] = ethosu_read_1[0, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:5, 0:9, 0:3])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[0, hh, ww, cc] = ethosu_convert_to_nhwc_1[0, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad_1[0:1, 0:5, 0:9, 0:3])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[0, hh, ww, cc] = ethosu_upscale_1[0, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:5, 0:9, 0:3])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise[0, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[0, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:5, 0:9, 0:3])
        i0_4 = T.int32()
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16[0, i1, i2, i3] = ethosu_binary_elementwise[0, i1, i2, i3]
        T.realize(ethosu_write[0:1, 0:5, 0:9, 0:3])
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write[0, i1, i2, i3] = ethosu_convert_to_nhcwb16[0, i1, i2, i3]
after RemoveConcatenates,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read[0:1, 0:5, 0:9, 0:3])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:5, 0:9, 0:3])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc[0, i1, i2, i3] = ethosu_read[0, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale[0:1, 0:5, 0:9, 0:3])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale[0, hh, ww, cc] = ethosu_convert_to_nhwc[0, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad[0:1, 0:5, 0:9, 0:3])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad[0, hh, ww, cc] = ethosu_upscale[0, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read_1[0:1, 0:5, 0:9, 0:3])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:5, 0:9, 0:3])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[0, i1, i2, i3] = ethosu_read_1[0, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:5, 0:9, 0:3])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[0, hh, ww, cc] = ethosu_convert_to_nhwc_1[0, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad_1[0:1, 0:5, 0:9, 0:3])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[0, hh, ww, cc] = ethosu_upscale_1[0, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:5, 0:9, 0:3])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise[0, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[0, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:5, 0:9, 0:3])
        i0_4 = T.int32()
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16[0, i1, i2, i3] = ethosu_binary_elementwise[0, i1, i2, i3]
        T.realize(ethosu_write[0:1, 0:5, 0:9, 0:3])
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write[0, i1, i2, i3] = ethosu_convert_to_nhcwb16[0, i1, i2, i3]
after InjectRollingBuffer,mod:
 [15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.BufferShapeLegalize
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.BufferStrideLegalize
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.ThreadScopePropagate
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.BufferBindUnwrapper
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.ApplyLayoutTransforms
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.StorageFlattener
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.AssertSimplifier
# from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read[0:1, 0:5, 0:9, 0:3])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:5, 0:9, 0:3])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc[0, i1, i2, i3] = ethosu_read[0, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale[0:1, 0:5, 0:9, 0:3])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale[0, hh, ww, cc] = ethosu_convert_to_nhwc[0, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad[0:1, 0:5, 0:9, 0:3])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad[0, hh, ww, cc] = ethosu_upscale[0, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_read_1[0:1, 0:5, 0:9, 0:3])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:5, 0:9, 0:3])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[0, i1, i2, i3] = ethosu_read_1[0, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:5, 0:9, 0:3])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[0, hh, ww, cc] = ethosu_convert_to_nhwc_1[0, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_pad_1[0:1, 0:5, 0:9, 0:3])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[0, hh, ww, cc] = ethosu_upscale_1[0, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:5, 0:9, 0:3])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise[0, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[0, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 5, 9, 3), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:5, 0:9, 0:3])
        i0_4 = T.int32()
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16[0, i1, i2, i3] = ethosu_binary_elementwise[0, i1, i2, i3]
        T.realize(ethosu_write[0:1, 0:5, 0:9, 0:3])
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write[0, i1, i2, i3] = ethosu_convert_to_nhcwb16[0, i1, i2, i3]
after StorageFlatten,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([135], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((135,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc = T.allocate([135], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i1 * 27 + i2 * 3 + i3] = ethosu_read_1[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale = T.allocate([135], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((135,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_1[hh * 27 + ww * 3 + cc]
        ethosu_pad = T.allocate([135], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((135,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[hh * 27 + ww * 3 + cc] = ethosu_upscale_1[hh * 27 + ww * 3 + cc]
        ethosu_read_2 = T.allocate([135], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((135,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_3[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([135], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_3[i1 * 27 + i2 * 3 + i3] = ethosu_read_3[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale_2 = T.allocate([135], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((135,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_3[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_3[hh * 27 + ww * 3 + cc]
        ethosu_pad_2 = T.allocate([135], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((135,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_3[hh * 27 + ww * 3 + cc] = ethosu_upscale_3[hh * 27 + ww * 3 + cc]
        ethosu_binary_elementwise = T.allocate([135], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((135,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise_1[hh * 27 + ww * 3 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 27 + ww * 3 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 27 + ww * 3 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([135], "int8", "global")
        i0_4 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3] = ethosu_binary_elementwise_1[i1 * 27 + i2 * 3 + i3]
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 27 + i2 * 3 + i3] = ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3]
after UnrollLoop,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([135], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((135,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc = T.allocate([135], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i1 * 27 + i2 * 3 + i3] = ethosu_read_1[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale = T.allocate([135], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((135,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_1[hh * 27 + ww * 3 + cc]
        ethosu_pad = T.allocate([135], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((135,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[hh * 27 + ww * 3 + cc] = ethosu_upscale_1[hh * 27 + ww * 3 + cc]
        ethosu_read_2 = T.allocate([135], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((135,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_3[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([135], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_3[i1 * 27 + i2 * 3 + i3] = ethosu_read_3[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale_2 = T.allocate([135], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((135,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_3[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_3[hh * 27 + ww * 3 + cc]
        ethosu_pad_2 = T.allocate([135], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((135,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_3[hh * 27 + ww * 3 + cc] = ethosu_upscale_3[hh * 27 + ww * 3 + cc]
        ethosu_binary_elementwise = T.allocate([135], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((135,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise_1[hh * 27 + ww * 3 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 27 + ww * 3 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 27 + ww * 3 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([135], "int8", "global")
        i0_4 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3] = ethosu_binary_elementwise_1[i1 * 27 + i2 * 3 + i3]
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 27 + i2 * 3 + i3] = ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3]
after Simplify,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([135], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((135,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc = T.allocate([135], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i1 * 27 + i2 * 3 + i3] = ethosu_read_1[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale = T.allocate([135], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((135,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_1[hh * 27 + ww * 3 + cc]
        ethosu_pad = T.allocate([135], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((135,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[hh * 27 + ww * 3 + cc] = ethosu_upscale_1[hh * 27 + ww * 3 + cc]
        ethosu_read_2 = T.allocate([135], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((135,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_3[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([135], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_3[i1 * 27 + i2 * 3 + i3] = ethosu_read_3[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale_2 = T.allocate([135], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((135,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_3[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_3[hh * 27 + ww * 3 + cc]
        ethosu_pad_2 = T.allocate([135], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((135,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_3[hh * 27 + ww * 3 + cc] = ethosu_upscale_3[hh * 27 + ww * 3 + cc]
        ethosu_binary_elementwise = T.allocate([135], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((135,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise_1[hh * 27 + ww * 3 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 27 + ww * 3 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 27 + ww * 3 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([135], "int8", "global")
        i0_4 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3] = ethosu_binary_elementwise_1[i1 * 27 + i2 * 3 + i3]
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 27 + i2 * 3 + i3] = ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3]
after LoopPartition,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([135], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((135,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc = T.allocate([135], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i1 * 27 + i2 * 3 + i3] = ethosu_read_1[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale = T.allocate([135], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((135,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_1[hh * 27 + ww * 3 + cc]
        ethosu_pad = T.allocate([135], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((135,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[hh * 27 + ww * 3 + cc] = ethosu_upscale_1[hh * 27 + ww * 3 + cc]
        ethosu_read_2 = T.allocate([135], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((135,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_3[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([135], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_3[i1 * 27 + i2 * 3 + i3] = ethosu_read_3[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale_2 = T.allocate([135], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((135,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_3[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_3[hh * 27 + ww * 3 + cc]
        ethosu_pad_2 = T.allocate([135], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((135,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_3[hh * 27 + ww * 3 + cc] = ethosu_upscale_3[hh * 27 + ww * 3 + cc]
        ethosu_binary_elementwise = T.allocate([135], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((135,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise_1[hh * 27 + ww * 3 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 27 + ww * 3 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 27 + ww * 3 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([135], "int8", "global")
        i0_4 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3] = ethosu_binary_elementwise_1[i1 * 27 + i2 * 3 + i3]
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 27 + i2 * 3 + i3] = ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3]
after RemoveZeroStores,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([135], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((135,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc = T.allocate([135], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i1 * 27 + i2 * 3 + i3] = ethosu_read_1[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale = T.allocate([135], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((135,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_1[hh * 27 + ww * 3 + cc]
        ethosu_pad = T.allocate([135], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((135,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[hh * 27 + ww * 3 + cc] = ethosu_upscale_1[hh * 27 + ww * 3 + cc]
        ethosu_read_2 = T.allocate([135], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((135,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_3[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([135], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_3[i1 * 27 + i2 * 3 + i3] = ethosu_read_3[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale_2 = T.allocate([135], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((135,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_3[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_3[hh * 27 + ww * 3 + cc]
        ethosu_pad_2 = T.allocate([135], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((135,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_3[hh * 27 + ww * 3 + cc] = ethosu_upscale_3[hh * 27 + ww * 3 + cc]
        ethosu_binary_elementwise = T.allocate([135], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((135,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise_1[hh * 27 + ww * 3 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 27 + ww * 3 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 27 + ww * 3 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([135], "int8", "global")
        i0_4 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3] = ethosu_binary_elementwise_1[i1 * 27 + i2 * 3 + i3]
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 27 + i2 * 3 + i3] = ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3]
after Simplify,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([135], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((135,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc = T.allocate([135], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i1 * 27 + i2 * 3 + i3] = ethosu_read_1[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale = T.allocate([135], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((135,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_1[hh * 27 + ww * 3 + cc]
        ethosu_pad = T.allocate([135], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((135,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[hh * 27 + ww * 3 + cc] = ethosu_upscale_1[hh * 27 + ww * 3 + cc]
        ethosu_read_2 = T.allocate([135], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((135,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_3[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([135], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_3[i1 * 27 + i2 * 3 + i3] = ethosu_read_3[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale_2 = T.allocate([135], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((135,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_3[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_3[hh * 27 + ww * 3 + cc]
        ethosu_pad_2 = T.allocate([135], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((135,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_3[hh * 27 + ww * 3 + cc] = ethosu_upscale_3[hh * 27 + ww * 3 + cc]
        ethosu_binary_elementwise = T.allocate([135], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((135,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise_1[hh * 27 + ww * 3 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 27 + ww * 3 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 27 + ww * 3 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([135], "int8", "global")
        i0_4 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3] = ethosu_binary_elementwise_1[i1 * 27 + i2 * 3 + i3]
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 27 + i2 * 3 + i3] = ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3]
after RemoveNoOp,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([135], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((135,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_1[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc = T.allocate([135], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_1[i1 * 27 + i2 * 3 + i3] = ethosu_read_1[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale = T.allocate([135], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((135,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_1[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_1[hh * 27 + ww * 3 + cc]
        ethosu_pad = T.allocate([135], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((135,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_1[hh * 27 + ww * 3 + cc] = ethosu_upscale_1[hh * 27 + ww * 3 + cc]
        ethosu_read_2 = T.allocate([135], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((135,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_2, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_read_3[i1 * 27 + i2 * 3 + i3] = ifm_1[i1 * 27 + i2 * 3 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([135], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhwc_3[i1 * 27 + i2 * 3 + i3] = ethosu_read_3[i1 * 27 + i2 * 3 + i3]
        ethosu_upscale_2 = T.allocate([135], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((135,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_upscale_3[hh * 27 + ww * 3 + cc] = ethosu_convert_to_nhwc_3[hh * 27 + ww * 3 + cc]
        ethosu_pad_2 = T.allocate([135], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((135,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_pad_3[hh * 27 + ww * 3 + cc] = ethosu_upscale_3[hh * 27 + ww * 3 + cc]
        ethosu_binary_elementwise = T.allocate([135], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((135,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 5, 9, 3):
                ethosu_binary_elementwise_1[hh * 27 + ww * 3 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 27 + ww * 3 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 27 + ww * 3 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([135], "int8", "global")
        i0_4 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((135,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_4, i1, i2, i3 in T.grid(1, 5, 9, 3):
                ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3] = ethosu_binary_elementwise_1[i1 * 27 + i2 * 3 + i3]
        i0_5 = T.int32()
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_layout", "NHWC")
        T.attr(T.iter_var(i0_5, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_5, i1, i2, i3 in T.grid(1, 5, 9, 3):
            ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 27 + i2 * 3 + i3] = ethosu_convert_to_nhcwb16_1[i1 * 27 + i2 * 3 + i3]
after ReplaceOperators,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
after ReplaceOperators,mod:
  main_func before MergeConstantsMutator: 
# from tvm.script import tir as T

@T.prim_func
def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
    T.func_attr({"ethos-u.const_dict": {}, "from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
    ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
    ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
    T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
params is :
 [ifm, ethosu_write]
body is :
 ifm = T.Buffer((135,), "int8")
ethosu_write = T.Buffer((135,), "int8")
T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
buffer_map is :
 {ethosu_write: ethosu_write, ifm: ifm}
attrs is :
 {"ethos-u.const_dict": {}, "from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)}
# from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
after EncodeConstants,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
after EncodeConstants,const_dict:
 {}
after HoistAllocates,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
after RemoveNoOp,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
------------------------MergeConstants------------------------
mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
const_dict:
 {}
after MergeConstants
mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
const_dict:
 {} 
------------------------End MergeConstants------------------------
zedebug:lower_ethosu after:mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
zedebug:lower_ethosu after:consts:
 {}
zedebug:***************** _lower_to_tir end *****************
# from tvm.script import tir as T

@T.prim_func
def main(ifm: T.Buffer((1, 5, 9, 3), "int8"), ethosu_write: T.Buffer((1, 5, 9, 3), "int8")):
    T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
    ifm_1 = T.Buffer((135,), "int8", data=ifm.data)
    ethosu_write_1 = T.Buffer((135,), "int8", data=ethosu_write.data)
    T.call_extern("handle", "ethosu_binary_elementwise", "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "int8", 5, 9, 3, 5, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 27, 3, 1, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
.[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:379: InferType: Executing module pass with opt level: 0
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/relay/backend/te_compiler_cache.cc:1186: Constant tensors map size: 0
zedebug:***************** _lower_to_tir: *****************
zedebug: extract_constants before,func:
 fn (%ifm: Tensor[(1, 8, 9, 40), int8] /* ty=Tensor[(1, 8, 9, 40), int8] */) -> Tensor[(1, 8, 3, 9, 16), int8] {
  contrib.ethosu.binary_elementwise(%ifm, %ifm, meta[relay.Constant][0] /* ty=Tensor[(0), int8] */, operator_type="MUL", ifm_scale=1f, ifm_zero_point=0, ifm2_scale=1f, ifm2_zero_point=0, ofm_scale=1f, ofm_zero_point=0, ifm_channels=40, ifm2_channels=40, activation="CLIP", clip_min=10, clip_max=100, ofm_layout="NHCWB16", ofm_dtype="int8") /* ty=Tensor[(1, 8, 3, 9, 16), int8] */
} /* ty=fn (Tensor[(1, 8, 9, 40), int8]) -> Tensor[(1, 8, 3, 9, 16), int8] */

zedebug: extract_constants after,func:
 fn (%ifm: Tensor[(1, 8, 9, 40), int8] /* ty=Tensor[(1, 8, 9, 40), int8] */, %p1: Tensor[(0), int8] /* ty=Tensor[(0), int8] */) -> Tensor[(1, 8, 3, 9, 16), int8] {
  contrib.ethosu.binary_elementwise(%ifm, %ifm, %p1, operator_type="MUL", ifm_scale=1f, ifm_zero_point=0, ifm2_scale=1f, ifm2_zero_point=0, ofm_scale=1f, ofm_zero_point=0, ifm_channels=40, ifm2_channels=40, activation="CLIP", clip_min=10, clip_max=100, ofm_layout="NHCWB16", ofm_dtype="int8") /* ty=Tensor[(1, 8, 3, 9, 16), int8] */
} /* ty=fn (Tensor[(1, 8, 9, 40), int8], Tensor[(0), int8]) -> Tensor[(1, 8, 3, 9, 16), int8] */
zedebug: extract_constants after,consts:
 {1: array([], dtype=int8)}
zedebug:lower_to_te befor  func :
 fn (%ifm: Tensor[(1, 8, 9, 40), int8] /* ty=Tensor[(1, 8, 9, 40), int8] */, %p1: Tensor[(0), int8] /* ty=Tensor[(0), int8] */) -> Tensor[(1, 8, 3, 9, 16), int8] {
  contrib.ethosu.binary_elementwise(%ifm, %ifm, %p1, operator_type="MUL", ifm_scale=1f, ifm_zero_point=0, ifm2_scale=1f, ifm2_zero_point=0, ofm_scale=1f, ofm_zero_point=0, ifm_channels=40, ifm2_channels=40, activation="CLIP", clip_min=10, clip_max=100, ofm_layout="NHCWB16", ofm_dtype="int8") /* ty=Tensor[(1, 8, 3, 9, 16), int8] */
} /* ty=fn (Tensor[(1, 8, 9, 40), int8], Tensor[(0), int8]) -> Tensor[(1, 8, 3, 9, 16), int8] */
zedebug:lower_to_te after  cached_func:
 relay.CachedFunc(0x60fc36b1bea0)
#[version = "0.0.5"]

cached_func.outputs:
 [Tensor(shape=[1, 8, 3, 9, 16], op.name=ethosu_write)]
cached_func.inputs:
 [Tensor(shape=[1, 8, 9, 40], op.name=ifm), Tensor(shape=[0], op.name=p1)]
zedebug:lower_to_tir:schedule:s:
 schedule(0x60fc36b305f0)
zedebug:lower_to_tir:cached_func:
 relay.CachedFunc(0x60fc36b1bea0)
before schedule_to_module,sch:
 schedule(0x60fc36b506b0)
before schedule_to_module,args:
 [Tensor(shape=[1, 8, 9, 40], op.name=ifm), Tensor(shape=[0], op.name=p1), Tensor(shape=[1, 8, 3, 9, 16], op.name=ethosu_write)]
before schedule_to_module,name:
 main
after schedule_to_module,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read[0:1, 0:8, 0:9, 0:40])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read[i0, i1, i2, i3] = ifm[i0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:8, 0:9, 0:40])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc[i0_1, i1, i2, i3] = ethosu_read[i0_1, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale[0:1, 0:8, 0:9, 0:40])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale[nn, hh, ww, cc] = ethosu_convert_to_nhwc[nn, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad[0:1, 0:8, 0:9, 0:40])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad[nn_1, hh, ww, cc] = ethosu_upscale[nn_1, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read_1[0:1, 0:8, 0:9, 0:40])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i0_2, i1, i2, i3] = ifm[i0_2, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:8, 0:9, 0:40])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i0_3, i1, i2, i3] = ethosu_read_1[i0_3, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:8, 0:9, 0:40])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[nn_2, hh, ww, cc] = ethosu_convert_to_nhwc_1[nn_2, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad_1[0:1, 0:8, 0:9, 0:40])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[nn_3, hh, ww, cc] = ethosu_upscale_1[nn_3, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:8, 0:9, 0:40])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise[nn_4, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[nn_4, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 8, 3, 9, 16), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:8, 0:3, 0:9, 0:16])
        nn_5 = T.int32()
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16[nn_5, hh, cc, ww, cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise[nn_5, hh, ww, cc * 16 + cb], T.int8(0))
        T.realize(ethosu_write[0:1, 0:8, 0:3, 0:9, 0:16])
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write[i0_4, i1, i2, i3, i4] = ethosu_convert_to_nhcwb16[i0_4, i1, i2, i3, i4]
after Simplify,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read[0:1, 0:8, 0:9, 0:40])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:8, 0:9, 0:40])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc[0, i1, i2, i3] = ethosu_read[0, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale[0:1, 0:8, 0:9, 0:40])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale[0, hh, ww, cc] = ethosu_convert_to_nhwc[0, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad[0:1, 0:8, 0:9, 0:40])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad[0, hh, ww, cc] = ethosu_upscale[0, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read_1[0:1, 0:8, 0:9, 0:40])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:8, 0:9, 0:40])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[0, i1, i2, i3] = ethosu_read_1[0, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:8, 0:9, 0:40])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[0, hh, ww, cc] = ethosu_convert_to_nhwc_1[0, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad_1[0:1, 0:8, 0:9, 0:40])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[0, hh, ww, cc] = ethosu_upscale_1[0, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:8, 0:9, 0:40])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise[0, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[0, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 8, 3, 9, 16), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:8, 0:3, 0:9, 0:16])
        nn_5 = T.int32()
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16[0, hh, cc, ww, cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise[0, hh, ww, cc * 16 + cb], T.int8(0))
        T.realize(ethosu_write[0:1, 0:8, 0:3, 0:9, 0:16])
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write[0, i1, i2, i3, i4] = ethosu_convert_to_nhcwb16[0, i1, i2, i3, i4]
after RemoveConcatenates,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read[0:1, 0:8, 0:9, 0:40])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:8, 0:9, 0:40])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc[0, i1, i2, i3] = ethosu_read[0, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale[0:1, 0:8, 0:9, 0:40])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale[0, hh, ww, cc] = ethosu_convert_to_nhwc[0, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad[0:1, 0:8, 0:9, 0:40])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad[0, hh, ww, cc] = ethosu_upscale[0, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read_1[0:1, 0:8, 0:9, 0:40])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:8, 0:9, 0:40])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[0, i1, i2, i3] = ethosu_read_1[0, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:8, 0:9, 0:40])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[0, hh, ww, cc] = ethosu_convert_to_nhwc_1[0, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad_1[0:1, 0:8, 0:9, 0:40])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[0, hh, ww, cc] = ethosu_upscale_1[0, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:8, 0:9, 0:40])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise[0, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[0, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 8, 3, 9, 16), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:8, 0:3, 0:9, 0:16])
        nn_5 = T.int32()
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16[0, hh, cc, ww, cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise[0, hh, ww, cc * 16 + cb], T.int8(0))
        T.realize(ethosu_write[0:1, 0:8, 0:3, 0:9, 0:16])
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write[0, i1, i2, i3, i4] = ethosu_convert_to_nhcwb16[0, i1, i2, i3, i4]
after InjectRollingBuffer,mod:
 [15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.BufferShapeLegalize
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.BufferStrideLegalize
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.ThreadScopePropagate
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.BufferBindUnwrapper
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.ApplyLayoutTransforms
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.StorageFlattener
[15:52:02] /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/src/ir/transform.cc:442: Running pass tir.AssertSimplifier
# from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read[0:1, 0:8, 0:9, 0:40])
        i0 = T.int32()
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc[0:1, 0:8, 0:9, 0:40])
        i0_1 = T.int32()
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc[0, i1, i2, i3] = ethosu_read[0, i1, i2, i3]
        ethosu_upscale = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale[0:1, 0:8, 0:9, 0:40])
        nn = T.int32()
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale[0, hh, ww, cc] = ethosu_convert_to_nhwc[0, hh, ww, cc]
        ethosu_pad = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad[0:1, 0:8, 0:9, 0:40])
        nn_1 = T.int32()
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad[0, hh, ww, cc] = ethosu_upscale[0, hh, ww, cc]
        ethosu_read_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_read_1[0:1, 0:8, 0:9, 0:40])
        i0_2 = T.int32()
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[0, i1, i2, i3] = ifm[0, i1, i2, i3]
        ethosu_convert_to_nhwc_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_convert_to_nhwc_1[0:1, 0:8, 0:9, 0:40])
        i0_3 = T.int32()
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[0, i1, i2, i3] = ethosu_read_1[0, i1, i2, i3]
        ethosu_upscale_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_upscale_1[0:1, 0:8, 0:9, 0:40])
        nn_2 = T.int32()
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[0, hh, ww, cc] = ethosu_convert_to_nhwc_1[0, hh, ww, cc]
        ethosu_pad_1 = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_pad_1[0:1, 0:8, 0:9, 0:40])
        nn_3 = T.int32()
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[0, hh, ww, cc] = ethosu_upscale_1[0, hh, ww, cc]
        ethosu_binary_elementwise = T.Buffer((1, 8, 9, 40), "int8")
        T.realize(ethosu_binary_elementwise[0:1, 0:8, 0:9, 0:40])
        nn_4 = T.int32()
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise[0, hh, ww, cc] = T.Cast("int8", T.Cast("int32", ethosu_pad[0, hh, ww, cc]) * T.Cast("int32", ethosu_pad_1[0, hh, ww, cc]))
        ethosu_convert_to_nhcwb16 = T.Buffer((1, 8, 3, 9, 16), "int8")
        T.realize(ethosu_convert_to_nhcwb16[0:1, 0:8, 0:3, 0:9, 0:16])
        nn_5 = T.int32()
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16[0, hh, cc, ww, cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise[0, hh, ww, cc * 16 + cb], T.int8(0))
        T.realize(ethosu_write[0:1, 0:8, 0:3, 0:9, 0:16])
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write[0, i1, i2, i3, i4] = ethosu_convert_to_nhcwb16[0, i1, i2, i3, i4]
after StorageFlatten,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([2880], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((2880,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc = T.allocate([2880], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i1 * 360 + i2 * 40 + i3] = ethosu_read_1[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale = T.allocate([2880], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((2880,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_1[hh * 360 + ww * 40 + cc]
        ethosu_pad = T.allocate([2880], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((2880,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[hh * 360 + ww * 40 + cc] = ethosu_upscale_1[hh * 360 + ww * 40 + cc]
        ethosu_read_2 = T.allocate([2880], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((2880,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_3[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([2880], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_3[i1 * 360 + i2 * 40 + i3] = ethosu_read_3[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale_2 = T.allocate([2880], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((2880,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_3[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_3[hh * 360 + ww * 40 + cc]
        ethosu_pad_2 = T.allocate([2880], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((2880,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_3[hh * 360 + ww * 40 + cc] = ethosu_upscale_3[hh * 360 + ww * 40 + cc]
        ethosu_binary_elementwise = T.allocate([2880], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((2880,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 360 + ww * 40 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 360 + ww * 40 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([3456], "int8", "global")
        nn_5 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((3456,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16_1[hh * 432 + cc * 144 + ww * 16 + cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc * 16 + cb], T.int8(0))
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 432 + i2 * 144 + i3 * 16 + i4] = ethosu_convert_to_nhcwb16_1[i1 * 432 + i2 * 144 + i3 * 16 + i4]
after UnrollLoop,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([2880], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((2880,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc = T.allocate([2880], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i1 * 360 + i2 * 40 + i3] = ethosu_read_1[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale = T.allocate([2880], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((2880,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_1[hh * 360 + ww * 40 + cc]
        ethosu_pad = T.allocate([2880], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((2880,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[hh * 360 + ww * 40 + cc] = ethosu_upscale_1[hh * 360 + ww * 40 + cc]
        ethosu_read_2 = T.allocate([2880], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((2880,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_3[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([2880], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_3[i1 * 360 + i2 * 40 + i3] = ethosu_read_3[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale_2 = T.allocate([2880], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((2880,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_3[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_3[hh * 360 + ww * 40 + cc]
        ethosu_pad_2 = T.allocate([2880], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((2880,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_3[hh * 360 + ww * 40 + cc] = ethosu_upscale_3[hh * 360 + ww * 40 + cc]
        ethosu_binary_elementwise = T.allocate([2880], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((2880,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 360 + ww * 40 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 360 + ww * 40 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([3456], "int8", "global")
        nn_5 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((3456,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16_1[hh * 432 + cc * 144 + ww * 16 + cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc * 16 + cb], T.int8(0))
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 432 + i2 * 144 + i3 * 16 + i4] = ethosu_convert_to_nhcwb16_1[i1 * 432 + i2 * 144 + i3 * 16 + i4]
after Simplify,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([2880], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((2880,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc = T.allocate([2880], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i1 * 360 + i2 * 40 + i3] = ethosu_read_1[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale = T.allocate([2880], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((2880,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_1[hh * 360 + ww * 40 + cc]
        ethosu_pad = T.allocate([2880], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((2880,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[hh * 360 + ww * 40 + cc] = ethosu_upscale_1[hh * 360 + ww * 40 + cc]
        ethosu_read_2 = T.allocate([2880], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((2880,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_3[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([2880], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_3[i1 * 360 + i2 * 40 + i3] = ethosu_read_3[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale_2 = T.allocate([2880], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((2880,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_3[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_3[hh * 360 + ww * 40 + cc]
        ethosu_pad_2 = T.allocate([2880], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((2880,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_3[hh * 360 + ww * 40 + cc] = ethosu_upscale_3[hh * 360 + ww * 40 + cc]
        ethosu_binary_elementwise = T.allocate([2880], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((2880,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 360 + ww * 40 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 360 + ww * 40 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([3456], "int8", "global")
        nn_5 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((3456,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16_1[hh * 432 + cc * 144 + ww * 16 + cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc * 16 + cb], T.int8(0))
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 432 + i2 * 144 + i3 * 16 + i4] = ethosu_convert_to_nhcwb16_1[i1 * 432 + i2 * 144 + i3 * 16 + i4]
after LoopPartition,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([2880], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((2880,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc = T.allocate([2880], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i1 * 360 + i2 * 40 + i3] = ethosu_read_1[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale = T.allocate([2880], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((2880,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_1[hh * 360 + ww * 40 + cc]
        ethosu_pad = T.allocate([2880], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((2880,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[hh * 360 + ww * 40 + cc] = ethosu_upscale_1[hh * 360 + ww * 40 + cc]
        ethosu_read_2 = T.allocate([2880], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((2880,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_3[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([2880], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_3[i1 * 360 + i2 * 40 + i3] = ethosu_read_3[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale_2 = T.allocate([2880], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((2880,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_3[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_3[hh * 360 + ww * 40 + cc]
        ethosu_pad_2 = T.allocate([2880], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((2880,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_3[hh * 360 + ww * 40 + cc] = ethosu_upscale_3[hh * 360 + ww * 40 + cc]
        ethosu_binary_elementwise = T.allocate([2880], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((2880,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 360 + ww * 40 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 360 + ww * 40 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([3456], "int8", "global")
        nn_5 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((3456,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16_1[hh * 432 + cc * 144 + ww * 16 + cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc * 16 + cb], T.int8(0))
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 432 + i2 * 144 + i3 * 16 + i4] = ethosu_convert_to_nhcwb16_1[i1 * 432 + i2 * 144 + i3 * 16 + i4]
after RemoveZeroStores,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([2880], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((2880,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc = T.allocate([2880], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i1 * 360 + i2 * 40 + i3] = ethosu_read_1[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale = T.allocate([2880], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((2880,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_1[hh * 360 + ww * 40 + cc]
        ethosu_pad = T.allocate([2880], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((2880,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[hh * 360 + ww * 40 + cc] = ethosu_upscale_1[hh * 360 + ww * 40 + cc]
        ethosu_read_2 = T.allocate([2880], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((2880,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_3[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([2880], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_3[i1 * 360 + i2 * 40 + i3] = ethosu_read_3[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale_2 = T.allocate([2880], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((2880,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_3[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_3[hh * 360 + ww * 40 + cc]
        ethosu_pad_2 = T.allocate([2880], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((2880,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_3[hh * 360 + ww * 40 + cc] = ethosu_upscale_3[hh * 360 + ww * 40 + cc]
        ethosu_binary_elementwise = T.allocate([2880], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((2880,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 360 + ww * 40 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 360 + ww * 40 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([3456], "int8", "global")
        nn_5 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((3456,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16_1[hh * 432 + cc * 144 + ww * 16 + cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc * 16 + cb], T.int8(0))
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 432 + i2 * 144 + i3 * 16 + i4] = ethosu_convert_to_nhcwb16_1[i1 * 432 + i2 * 144 + i3 * 16 + i4]
after Simplify,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([2880], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((2880,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc = T.allocate([2880], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i1 * 360 + i2 * 40 + i3] = ethosu_read_1[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale = T.allocate([2880], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((2880,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_1[hh * 360 + ww * 40 + cc]
        ethosu_pad = T.allocate([2880], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((2880,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[hh * 360 + ww * 40 + cc] = ethosu_upscale_1[hh * 360 + ww * 40 + cc]
        ethosu_read_2 = T.allocate([2880], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((2880,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_3[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([2880], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_3[i1 * 360 + i2 * 40 + i3] = ethosu_read_3[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale_2 = T.allocate([2880], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((2880,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_3[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_3[hh * 360 + ww * 40 + cc]
        ethosu_pad_2 = T.allocate([2880], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((2880,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_3[hh * 360 + ww * 40 + cc] = ethosu_upscale_3[hh * 360 + ww * 40 + cc]
        ethosu_binary_elementwise = T.allocate([2880], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((2880,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 360 + ww * 40 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 360 + ww * 40 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([3456], "int8", "global")
        nn_5 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((3456,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16_1[hh * 432 + cc * 144 + ww * 16 + cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc * 16 + cb], T.int8(0))
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 432 + i2 * 144 + i3 * 16 + i4] = ethosu_convert_to_nhcwb16_1[i1 * 432 + i2 * 144 + i3 * 16 + i4]
after RemoveNoOp,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ethosu_read = T.allocate([2880], "int8", "global")
        i0 = T.int32()
        ethosu_read_1 = T.Buffer((2880,), "int8", data=ethosu_read)
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        with T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_1[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc = T.allocate([2880], "int8", "global")
        i0_1 = T.int32()
        ethosu_convert_to_nhwc_1 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc)
        with T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_1, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_1, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_1[i1 * 360 + i2 * 40 + i3] = ethosu_read_1[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale = T.allocate([2880], "int8", "global")
        nn = T.int32()
        ethosu_upscale_1 = T.Buffer((2880,), "int8", data=ethosu_upscale)
        with T.attr(T.iter_var(nn, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_1[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_1[hh * 360 + ww * 40 + cc]
        ethosu_pad = T.allocate([2880], "int8", "global")
        nn_1 = T.int32()
        ethosu_pad_1 = T.Buffer((2880,), "int8", data=ethosu_pad)
        with T.attr(T.iter_var(nn_1, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_1, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_1[hh * 360 + ww * 40 + cc] = ethosu_upscale_1[hh * 360 + ww * 40 + cc]
        ethosu_read_2 = T.allocate([2880], "int8", "global")
        i0_2 = T.int32()
        ethosu_read_3 = T.Buffer((2880,), "int8", data=ethosu_read_2)
        with T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_op", "ethosu_read"):
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_zero_point", 0)
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_layout", "NHWC")
            T.attr(T.iter_var(i0_2, None, "DataPar", ""), "pragma_scale", T.float32(1))
            for i0_2, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_read_3[i1 * 360 + i2 * 40 + i3] = ifm_1[i1 * 360 + i2 * 40 + i3]
        ethosu_convert_to_nhwc_2 = T.allocate([2880], "int8", "global")
        i0_3 = T.int32()
        ethosu_convert_to_nhwc_3 = T.Buffer((2880,), "int8", data=ethosu_convert_to_nhwc_2)
        with T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhwc"):
            T.attr(T.iter_var(i0_3, None, "DataPar", ""), "pragma_layout", "NHWC")
            for i0_3, i1, i2, i3 in T.grid(1, 8, 9, 40):
                ethosu_convert_to_nhwc_3[i1 * 360 + i2 * 40 + i3] = ethosu_read_3[i1 * 360 + i2 * 40 + i3]
        ethosu_upscale_2 = T.allocate([2880], "int8", "global")
        nn_2 = T.int32()
        ethosu_upscale_3 = T.Buffer((2880,), "int8", data=ethosu_upscale_2)
        with T.attr(T.iter_var(nn_2, None, "DataPar", ""), "pragma_op", "ethosu_upscale"):
            for nn_2, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_upscale_3[hh * 360 + ww * 40 + cc] = ethosu_convert_to_nhwc_3[hh * 360 + ww * 40 + cc]
        ethosu_pad_2 = T.allocate([2880], "int8", "global")
        nn_3 = T.int32()
        ethosu_pad_3 = T.Buffer((2880,), "int8", data=ethosu_pad_2)
        with T.attr(T.iter_var(nn_3, None, "DataPar", ""), "pragma_op", "ethosu_pad"):
            for nn_3, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_pad_3[hh * 360 + ww * 40 + cc] = ethosu_upscale_3[hh * 360 + ww * 40 + cc]
        ethosu_binary_elementwise = T.allocate([2880], "int8", "global")
        nn_4 = T.int32()
        ethosu_binary_elementwise_1 = T.Buffer((2880,), "int8", data=ethosu_binary_elementwise)
        with T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_op", "ethosu_binary_elementwise"):
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_max", 100)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_scale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_use_rescale", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rescale_shift", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_clip_min", 10)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_activation", "CLIP")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_reversed_operands", 0)
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_rounding_mode", "TFL")
            T.attr(T.iter_var(nn_4, None, "DataPar", ""), "pragma_operator_type", "MUL")
            for nn_4, hh, ww, cc in T.grid(1, 8, 9, 40):
                ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc] = T.Cast("int8", T.Cast("int32", ethosu_pad_1[hh * 360 + ww * 40 + cc]) * T.Cast("int32", ethosu_pad_3[hh * 360 + ww * 40 + cc]))
        ethosu_convert_to_nhcwb16 = T.allocate([3456], "int8", "global")
        nn_5 = T.int32()
        ethosu_convert_to_nhcwb16_1 = T.Buffer((3456,), "int8", data=ethosu_convert_to_nhcwb16)
        with T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_op", "ethosu_convert_to_nhcwb16"):
            T.attr(T.iter_var(nn_5, None, "DataPar", ""), "pragma_layout", "NHCWB16")
            for nn_5, hh, cc, ww, cb in T.grid(1, 8, 3, 9, 16):
                ethosu_convert_to_nhcwb16_1[hh * 432 + cc * 144 + ww * 16 + cb] = T.if_then_else(cc * 16 + cb < 40, ethosu_binary_elementwise_1[hh * 360 + ww * 40 + cc * 16 + cb], T.int8(0))
        i0_4 = T.int32()
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_op", "ethosu_write")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_zero_point", 0)
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_layout", "NHCWB16")
        T.attr(T.iter_var(i0_4, None, "DataPar", ""), "pragma_scale", T.float32(1))
        for i0_4, i1, i2, i3, i4 in T.grid(1, 8, 3, 9, 16):
            ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
            ethosu_write_1[i1 * 432 + i2 * 144 + i3 * 16 + i4] = ethosu_convert_to_nhcwb16_1[i1 * 432 + i2 * 144 + i3 * 16 + i4]
after ReplaceOperators,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
after ReplaceOperators,mod:
  main_func before MergeConstantsMutator: 
# from tvm.script import tir as T

@T.prim_func
def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
    T.func_attr({"ethos-u.const_dict": {}, "from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
    ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
    ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
    T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
params is :
 [ifm, ethosu_write]
body is :
 ifm = T.Buffer((2880,), "int8")
ethosu_write = T.Buffer((3456,), "int8")
T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
buffer_map is :
 {ethosu_write: ethosu_write, ifm: ifm}
attrs is :
 {"ethos-u.const_dict": {}, "from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)}
# from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), p1: T.Buffer((0,), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
after EncodeConstants,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
after EncodeConstants,const_dict:
 {}
after HoistAllocates,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
after RemoveNoOp,mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
------------------------MergeConstants------------------------
mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
const_dict:
 {}
after MergeConstants
mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
const_dict:
 {} 
------------------------End MergeConstants------------------------
zedebug:lower_ethosu after:mod:
 # from tvm.script import ir as I
# from tvm.script import tir as T

@I.ir_module
class Module:
    @T.prim_func
    def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
        T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
        ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
        ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
        T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
zedebug:lower_ethosu after:consts:
 {}
zedebug:***************** _lower_to_tir end *****************
# from tvm.script import tir as T

@T.prim_func
def main(ifm: T.Buffer((1, 8, 9, 40), "int8"), ethosu_write: T.Buffer((1, 8, 3, 9, 16), "int8")):
    T.func_attr({"from_legacy_te_schedule": T.bool(True), "global_symbol": "main", "tir.noalias": T.bool(True)})
    ifm_1 = T.Buffer((2880,), "int8", data=ifm.data)
    ethosu_write_1 = T.Buffer((3456,), "int8", data=ethosu_write.data)
    T.call_extern("handle", "ethosu_binary_elementwise", "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ifm_1[0], 0, 0, 0, T.float32(1), 0, "NHWC", 360, 40, 1, "int8", 8, 9, 40, 8, 0, 9, ethosu_write_1[0], 0, 0, 0, T.float32(1), 0, "NHCWB16", 432, 16, 144, "MUL", 0, "CLIP", 10, 100, "TFL", 0, 0, 0, 0, 0, 0)
.

=============================== warnings summary ===============================
../../../../../../../anaconda3/envs/tvm13/lib/python3.8/site-packages/ethosu/vela/_version.py:16
  /home/linzejia/anaconda3/envs/tvm13/lib/python3.8/site-packages/ethosu/vela/_version.py:16: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

../../../../../../../anaconda3/envs/tvm13/lib/python3.8/site-packages/pkg_resources/__init__.py:3154
  /home/linzejia/anaconda3/envs/tvm13/lib/python3.8/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('mpl_toolkits')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

../../../../../../../anaconda3/envs/tvm13/lib/python3.8/site-packages/pkg_resources/__init__.py:3154
../../../../../../../anaconda3/envs/tvm13/lib/python3.8/site-packages/pkg_resources/__init__.py:3154
../../../../../../../anaconda3/envs/tvm13/lib/python3.8/site-packages/pkg_resources/__init__.py:3154
../../../../../../../anaconda3/envs/tvm13/lib/python3.8/site-packages/pkg_resources/__init__.py:3154
  /home/linzejia/anaconda3/envs/tvm13/lib/python3.8/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sphinxcontrib')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

tests/python/contrib/test_ethosu/test_replace_binary_elementwise.py::test_binary_elementwise_single[NONE-MUL-ifm_shape0-ifm2_shape0-3-3-NHWC-NHWC-TFL]
tests/python/contrib/test_ethosu/test_replace_binary_elementwise.py::test_binary_elementwise_single[NONE-MUL-ifm_shape3-ifm2_shape3-40-40-NHWC-NHCWB16-TFL]
tests/python/contrib/test_ethosu/test_replace_binary_elementwise.py::test_binary_elementwise_single[CLIP-MUL-ifm_shape0-ifm2_shape0-3-3-NHWC-NHWC-TFL]
tests/python/contrib/test_ethosu/test_replace_binary_elementwise.py::test_binary_elementwise_single[CLIP-MUL-ifm_shape3-ifm2_shape3-40-40-NHWC-NHCWB16-TFL]
  /home/linzejia/app/tvm/apache-tvm-src-v0.13.0/python/tvm/runtime/ndarray.py:206: DeprecationWarning: NDArray.asnumpy() will be deprecated in TVM v0.8 release. Please use NDArray.numpy() instead.
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================ 4 passed, 92 deselected, 10 warnings in 3.48s =================
